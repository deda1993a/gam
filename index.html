<!DOCTYPE html>
<html lang="en">
<head>
    <style>
        .date {
            height: 40px;
            width: 140px;
            font-family: Arial, sans-serif;
            font-size: 14px;
            color: #000;
            padding-left: 15px;            
        }

        input::placeholder {
            color: gray;
            margin-left: 20px;
        }

        .datepicker-container {
            height: 330px;
            width: 300px;
            flex-direction: column;            
            font-family: Arial, sans-serif;
            font-size: 14px;
        }

        .root{
            height: 380px;
            width: 300px;
            box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .dateortine {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            width: 300px;
            height: 40px;
            font-weight: bold; 
        }

        .dateortine button {
            font-family: Arial, sans-serif;
            flex: 1;
            font-size: 16px;
            padding: 5px 10px;
            cursor: pointer;
            float: left;
            border: none;
            background-color: #EAEAEA;
            color: #7D7D7D;
            display: flex;
            align-items: center;
            text-align: center;
            justify-content: center;
            font-weight: bold;
        }

        .month-buttons button{
            font-family: Arial, sans-serif;
            flex: 1;
            font-size: 16px;
            padding: 5px 10px;
            cursor: pointer;
            float: left;
            border: none;
            background-color: #FFFFFF;
            color: #7D7D7D;
            display: flex;
            align-items: center;
            text-align: center;
            justify-content: center;
            font-weight: bold;
        }

        .confirm-buttons button {
            font-family: Arial, sans-serif;
            flex: 1;

            cursor: pointer;
            float: left;
            border: none;
  
           gap: 8px;
            display: flex;
            align-items: center;
            text-align: center;
            justify-content: center;
        
        }

        .dateortine button:hover {
            background-color: white;
       
        }

        /* Selected State */
        .dateortine button.selected-tab {
            background-color: white;
            color: #000;
            font-weight: bold;
        }

        .time-container .selectedMode{
            color: orange;
        }

        .dateortine img{
           
            width: 20px;
            height: 20px;
            margin-right: 8px;
            padding-top: 10px;
            padding-bottom: 10px;
        }

        .dateortine img::selecte {
            background-color: #2110b6 ;
        }

        .month-buttons {
            display: flex;
            justify-content: space-between;
            margin: 10px;           
            padding: 0;
            align-items: center;
        }

        .days-of-week {
            display: grid;
            grid-template-columns: repeat(7, 1fr); /* 7 columns for the days of the week */
            gap: 5px;
            font-weight: normal;
            text-transform: uppercase;
            margin-bottom: 10px;
            text-align: center;
            
        }

        .day {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #FFFFFF;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
        }

        .day:hover {
            background-color: #ddd;
        }

        .selected {
            background-color: #3F51B5;
            color: white;
        }

        .okBtnClass{
            display: flex;
  justify-content: flex-start; /* Default alignment for other elements */
  position: relative;  
  margin-left: auto;  /* Pushes the button to the right */
  margin-right: 21px; /* Adds the 21px gap to the right */
  width: 51px;
  height: 20px;
        }



       
.faded {
    color: rgba(0, 0, 0, 0.4); 
    width: 10px;
    height: 10px;
}

.day.past {
    color: rgba(0, 0, 0, 0.4); 
}


  

        .days-of-month {
            display: grid;
            grid-template-columns: repeat(7, 1fr); 
            gap: 10px;
            padding: 10px;
        }

        .input-container {
            display: flex;
            align-items: center;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding-right: 15px;
            width: 283px;
            height: 38px;
        }

        .input-container input {
            flex: 1;
            border: none;
            outline: none;

        }

        .input-container img {
            width: 20px;
            height: 20px;
            cursor: pointer;

        }



        .empty {
            visibility: hidden; 
        }

        .year{
            display:flex;
            flex-direction: column;
            position:relative;
            display: inline-block;
            font-size: 16px;
            border: none;
            font-family: Arial;
            width: 100px;
            appearance: none;
  background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23131313%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
  background-repeat: no-repeat;
  background-position: right 0.7rem top 50%;
  background-size: 0.65rem auto;
        }

        .year select:focus {
            outline: none;
            border: none; 
        }


.days-of-week {
    display: flex;
    justify-content: space-around; 
    border-bottom: 1px solid rgba(0, 0, 0, 0.5); 
    padding-bottom: 5px; 
}


.days-of-week .day-of-week {
    color: rgba(0, 0, 0, 0.5); 
    text-align: center;
    flex: 1; 
}




.day.disabled {
    color: rgba(0, 0, 0, 0.3); 
    cursor: not-allowed;
    pointer-events: none; 
    background-color: rgb(255, 255, 255); 
}

.clock-container{

height: 340px;
width: 300px;
}

.confirm-buttons {
    display: flex;
    margin-left: 21px;
    margin-bottom: 13px;
    gap: 20px;
}

.confirm-buttons img{
    width: 20px;
    height: 20px;
}

.okBtnClasstn {
    width: 51px;
    height: 20px;
}

.confirm-buttons button {
    border: none; 
    background: none; 
    font-size: 14px;
    cursor: pointer;
}

.confirm-buttons button:hover{
    background-color: #ddd;
}

.confirm-buttons div:hover{
    background-color: #ddd;
}

.time-container {
            font-family: Arial, sans-serif;
            font-size: 40px;
            display: flex;
            justify-content: center; /* Vízszintesen középre */
            align-items: center; 
            width: 300px;
            height: 67px;
            border-bottom: 1px solid #EAEAEA; 
            text-underline-offset: 8px;
            cursor: pointer;
        }
        .time-container .minute {
            text-decoration: underline;
        }
        .time-container .second {
            text-decoration: underline;
        }
        .time-container .hour {
            color: orange;
            text-decoration: underline;
        }
        .time-container .colon {
            text-decoration: none;
        }
        .time-container .hourformat {
            margin-left: 8px; 
            font-weight: normal;
            text-decoration: underline;
        }

        .time-container .minute:hover{
            color: orange;
        }

        .time-container .hour:hover{
            color: orange;
        }

        .time-container .second:hover{
            color: orange;
        }

        .time-container .hourformat:hover{
            color: orange;
        }





    </style>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Date Picker</title>
</head>
<body>
    <div class="input-container">
    <input type="text" class="date" placeholder="DD.MM.YYYY - HH:MM" disabled inputmode="">
    <img id="dateimg" src="DateTime.svg">
    </div>
    <div class="root">
        <div id="datetinesel" class="dateortine">

            <button id="dateBtn"><img src="Calendar.svg" alt="time" style="width: fit-content; min-width: fit-content;">
                <div class="dateBtnText">Date</div>
            </button>
            <button id="timeBtn"><img src="Time.svg">
                <div class="timeBtnText" style="width: fit-content; min-width: fit-content;">Time</div>
            </button>
        </div>
    <div id="datepicker" class="datepicker-container">


  
        <div id="month" class="month-buttons">
            <select class="year" id="yearSelect"></select>
            <div class="navBtns">
            <button id="prevMonthBtn">&lt;</button>            
            <button id="nextMonthBtn">&gt;</button>
            </div>
        </div>


        <div class="days-of-week" id="daysOfWeek"></div>

        <div class="days-of-month" id="daysOfMonth"></div>

        <div class="confirm-container">
            <div class="confirm-buttons">
                <button id="cancelBtn"><img src="clearBtn.png" alt="time">
                    <div class="cancelBtnText" style="width: fit-content; min-width: fit-content;">Clear</div>
                </button>
                <button id="okBtn"><img src="Ok.svg">
                    <div class="okBtnText" style="width: fit-content; min-width: fit-content;">Ok</div>
                </button>
            </div>
        </div>

        </div>
    

    <div id="clock" class="clock-container" hidden>
        <div class="time-container">
            <span id="time-unithourId" class="time-unit hour">10</span><span id="colonId" class="colon">:</span>
            <span id="time-unitminuteID" class="time-unit minute">00</span><span class="colon">:</span>
            <span id="time-unitsecondID" class="time-unit second">00</span>
            <span id="hourformatId" class="hourformat">PM</span>
        </div>
        <canvas id="clockCanvas" width="300" height="236"></canvas>
        <div class="confirm-time-container">
            <div class="confirm-buttons">
                <div id="imgTimeNowId" class="imgTimeNow">
                    <img src="TimeNow.svg" alt="TimeNow">
                </div>
                <div class="imgMorning">
                    <img src="Morning.svg" alt="Morning">
                </div>
                <div class="imgDay">
                    <img src="Day.svg" alt="Day">
                </div>
                <div class="imgEvening">
                    <img src="Night.svg" alt="Night">
                </div>
                <div class="okBtnClass">
                <button id="okBtn"><img src="Ok.svg">
                    <div class="okText" style="width: fit-content; min-width: fit-content;">Ok</div>
                </button>
            </div>
            </div>
        </div>
      </div>

    </div>


    <script>



        let currentYear, currentMonth;
        let currentSelectedTime = { hour: 0, minute: 0 }; // Default to 12:00

        const months = [
                'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
                'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'
            ];

function getYears() {
    const d = new Date();
    currentYear = d.getFullYear();
    currentMonth = d.getMonth(); 
    const yearSelect = document.getElementById('yearSelect');

    // Populate months in reverse order (Dec to Jan)
    for (let year = currentYear; year >= currentYear - 100; year--) {
        for (let i = months.length - 1; i >= 0; i--) {
            const month = months[i];
            const option = document.createElement('option');
            option.value = `${month} ${year}`;
            option.textContent = `${month} ${year}`;
            yearSelect.appendChild(option);
        }
    }

    // Set the default to the current month and year
    const defaultMonthYear = `${months[currentMonth]} ${currentYear}`;
    yearSelect.value = defaultMonthYear;

    // Event listener for when the user selects a new year/month
    yearSelect.addEventListener('change', function () {
        const selectedYearMonth = yearSelect.value.split(" ");
        currentMonth = months.indexOf(selectedYearMonth[0]);
        currentYear = parseInt(selectedYearMonth[1]);
        updateCalendar();
    });
}

// Function to update the days of the month based on the selected year and month
function generateDaysOfMonth() {
    const today = new Date(); 
    const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
    const firstDayOfMonth = new Date(currentYear, currentMonth, 1).getDay();

    const daysOfMonthDiv = document.getElementById('daysOfMonth');
    daysOfMonthDiv.innerHTML = ''; // Clear previous content

    // Add empty spaces for the first week if the month doesn't start on Sunday
    for (let i = 0; i < firstDayOfMonth; i++) {
        const emptyDiv = document.createElement('div');
        emptyDiv.classList.add('empty');
        daysOfMonthDiv.appendChild(emptyDiv);
    }

    // Add the days of the month
    for (let day = 1; day <= daysInMonth; day++) {
        const dayDiv = document.createElement('div');
        dayDiv.classList.add('day');
        dayDiv.textContent = day;

        // Check if the day has already passed
        const isPastDay = new Date(currentYear, currentMonth, day) < new Date(today.getFullYear(), today.getMonth(), today.getDate());

        if (isPastDay) {
            dayDiv.classList.add('disabled'); // Add disabled styling
        } else {
            dayDiv.onclick = function () {
                selectDay(dayDiv); // Make day clickable
            };
        }

        daysOfMonthDiv.appendChild(dayDiv);
    }
}


// Modify generateDaysOfWeek to apply faded style
function generateDaysOfWeek() {
    const daysOfWeek = ["S", "M", "T", "W", "T", "F", "S"];
    const daysOfWeekDiv = document.getElementById('daysOfWeek');
    
    // Add day names with faded style
    daysOfWeek.forEach(day => {
        const dayDiv = document.createElement('div');
        dayDiv.classList.add('day-of-week', 'faded'); 
        dayDiv.textContent = day;
        daysOfWeekDiv.appendChild(dayDiv);
    });
}

// Function to select a day and format the selected date
function selectDay(selectedDayDiv) {
    // Deselect any previously selected day
    const previouslySelectedDay = document.querySelector('.selected');
    console.log(previouslySelectedDay);
    if (previouslySelectedDay) {
        previouslySelectedDay.classList.remove('selected');
    }

    // Select the clicked day
    selectedDayDiv.classList.add('selected');

    // Update the input field with the selected date
    const formattedDate = getSelectedDate();
    if (formattedDate) {
        const inputField = document.querySelector('.date');
        inputField.value = formattedDate; // Update input with the selected date
    }
}


        // Function to go to the previous month
        function prevMonth() {
            if (currentMonth === 0) {
                currentMonth = 11; // December
                currentYear--;
            } else {
                currentMonth--;
            }
            updateCalendar();
        }

        // Function to go to the next month
        function nextMonth() {
            if (currentMonth === 11) {
                currentMonth = 0; // January
                currentYear++;
            } else {
                currentMonth++;
            }
            updateCalendar();
        }

// Function to update the calendar after changing the month or year
function updateCalendar() {
    const yearSelect = document.getElementById('yearSelect');
    yearSelect.value = `${months[currentMonth]} ${currentYear}`;
    generateDaysOfMonth();
}

let formattedDate;
let formattedFullTime;

function getSelectedDate() {
    const selectedDayDiv = document.querySelector('.selected');
    if (selectedDayDiv) {
        const selectedDay = selectedDayDiv.textContent;
        console.log(selectedDay);
        const selectedMonth = currentMonth + 1; // Months are 0-indexed
        const selectedYear = currentYear;

        // Format date as DD.MM.YYYY
        formattedDate = `${selectedDay.padStart(2, '0')}.${selectedMonth.toString().padStart(2, '0')}.${selectedYear}`;
        return formattedDate;
    }
    return null; 
}


window.onload = function () {
    getYears();
    generateDaysOfWeek();
    generateDaysOfMonth();

    // Initialize hidden elements
    const rootDiv = document.querySelector('.root');
    const datepicker = document.getElementById('datepicker');
    const clock = document.getElementById('clock');
    const dateImg = document.getElementById('dateimg');
    let dateImgOriginalSrc = "datepick1.png";
    let dateImgToggledSrc = "datepick2.png";

    rootDiv.hidden = true; 

    // Toggle visibility and change image source on clicking the image
    dateImg.onclick = function () {
        const isHidden = rootDiv.hidden;

        // Toggle visibility of root
        rootDiv.hidden = !isHidden;

        // Change the image source
        //dateImg.src = isHidden ? dateImgToggledSrc : dateImgOriginalSrc;

        if (isHidden) {
            // Trigger the dateBtn click event when root is shown
            document.getElementById('dateBtn').click();
        }
    };

    // Add event listeners for the "Date" and "Time" buttons
    document.getElementById('dateBtn').onclick = function () {
        clock.hidden = true;
        datepicker.hidden = false;
        this.classList.add('selected-tab');
        document.getElementById('timeBtn').classList.remove('selected-tab');

    };

    document.getElementById('timeBtn').onclick = function () {
            datepicker.hidden = true;
            clock.hidden = false;
            this.classList.add('selected-tab');
            document.getElementById('dateBtn').classList.remove('selected-tab');
        };

        document.getElementById('hourformatId').onclick = function () {
            let formatType=document.getElementById('hourformatId');
            formatType.textContent="AM";
            console.log("span");
        };

        document.getElementById('okBtn').onclick = function () {
    const formattedDate = getSelectedDate(); 
    if (formattedDate) {
        const inputField = document.querySelector('.date');
        inputField.value = formattedDate; // Set the selected date in the input
    }
    rootDiv.hidden = true; 
};

document.getElementById('cancelBtn').onclick = function () {
    const inputField = document.querySelector('.date');
    inputField.value = ''; // Reset input to the placeholder text
    rootDiv.hidden = true; 
};

    // Add the "Next" and "Prev" month buttons functionality
    document.getElementById('prevMonthBtn').onclick = prevMonth;
    document.getElementById('nextMonthBtn').onclick = nextMonth;
};

const canvas = document.getElementById('clockCanvas');
const ctx = canvas.getContext('2d');
const clockRadius = 110;
const centerX = 150;
const centerY = 118;

let outerRadius = clockRadius - 50;
let innerRadius = clockRadius - 20;

const hourCount = 12;
const minuteCount = 60; // Full minute positions
let currentMode = "hour"; // Modes: "hour", "minute", "second"

const hourPositions = [];
const innerHourPositions = [];
const minutePositions = [];
const allMinutePositions = []; // Holds positions for all minutes
let selectedPosition = null;
let cursorX = null;
let cursorY = null;
let isMouseDown = false;

let canSelectedDrawn=true;

function drawClock() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Fill the circle with a background color (gray)
    ctx.fillStyle = '#F4F4F4';
    ctx.beginPath();
    ctx.arc(centerX, centerY, clockRadius, 0, Math.PI * 2);
    ctx.fill();

    // Draw a small circle at the center of the clock
    ctx.fillStyle = '#FBE8CE';
    ctx.beginPath();
    ctx.arc(centerX, centerY, 5, 0, Math.PI * 2);
    ctx.fill();

    drawLine();

    if (currentMode === "hour") {
        drawHourClock();
    } else {
        drawMinuteSecondClock();
    }
    canSelectedDrawn=true;
}

function drawHourClock() {
    for (let i = 0; i < hourCount; i++) {
        const angle = (i * Math.PI) / 6 - Math.PI / 2;
        const xOuter = centerX + Math.cos(angle) * outerRadius;
        const yOuter = centerY + Math.sin(angle) * outerRadius;
        const xInner = centerX + Math.cos(angle) * innerRadius;
        const yInner = centerY + Math.sin(angle) * innerRadius;
        hourPositions[i] = { x: xOuter, y: yOuter };
        innerHourPositions[i] = { x: xInner, y: yInner };

        if(canSelectedDrawn==true){
            selectedPosition=currentSelectedTime.hour;
        }

        // Highlight outer circle
        if (selectedPosition === i) {
            ctx.beginPath();
            ctx.arc(xOuter, yOuter, 13, 0, Math.PI * 2);
            ctx.fillStyle = '#FBE8CE';
            ctx.fill();
        }

        // Highlight inner circle
        if (selectedPosition === i + hourCount) { // Adjust for inner circle positions
            ctx.beginPath();
            ctx.arc(xInner, yInner, 13, 0, Math.PI * 2);
            ctx.fillStyle = '#FBE8CE';
            ctx.fill();
        }

        ctx.font = "13px Arial";
        ctx.fillStyle = '#4E4E4E';
        ctx.fillText(i === 0 ? 12 : i, xOuter - 5, yOuter + 5);
        ctx.fillText(i === 0 ? 12 : i, xInner - 5, yInner + 5);
    }
}

function drawMinuteSecondClock() {
    minutePositions.length = 0; // Clear previous positions
    allMinutePositions.length = 0; // Clear all-minute positions
    for (let i = 0; i < minuteCount; i++) {
        const angle = (i * Math.PI) / 30 - Math.PI / 2; // Adjust for 60 divisions
        const x = centerX + Math.cos(angle) * outerRadius;
        const y = centerY + Math.sin(angle) * outerRadius;

        allMinutePositions[i] = { x, y, value: i };

        if (i % 5 === 0) {
            minutePositions[i] = { x, y, value: i }; // Store only selectable positions
        }

        if (selectedPosition === i) {
            ctx.beginPath();
            ctx.arc(x, y, 13, 0, Math.PI * 2);
            ctx.fillStyle = '#FBE8CE';
            ctx.fill();
        }

        ctx.font = "13px Arial";
        ctx.fillStyle = '#4E4E4E';
        if (i % 5 === 0) ctx.fillText(i, x - 5, y + 5); // Display only multiples of 5
    }
}

function drawLine() {
    if (cursorX !== null && cursorY !== null && selectedPosition === null) {
        const distFromCenter = Math.sqrt(
            Math.pow(cursorX - centerX, 2) + Math.pow(cursorY - centerY, 2)
        );

        if (distFromCenter <= clockRadius) { // Only draw if cursor is inside the main circle
            // Draw a line from the center to the cursor position
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.lineTo(cursorX, cursorY);
            ctx.strokeStyle = '#FBE8CE';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Draw the circle for the cursor
            ctx.beginPath();
            ctx.arc(cursorX, cursorY, 5, 0, Math.PI * 2);
            ctx.fillStyle = '#FBE8CE';
            ctx.fill();
        }
    }

    if (selectedPosition !== null) {
        const positions = currentMode === "hour"
            ? [...hourPositions, ...innerHourPositions]
            : minutePositions;

        const pos = positions[selectedPosition];
        if (pos) {
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.lineTo(pos.x, pos.y);
            ctx.strokeStyle = '#FBE8CE';
            ctx.lineWidth = 2;
            ctx.stroke();
        }
    }
}


function startDrag(event) {
    isMouseDown = true;
    updateCursorPosition(event);
    handleSelection();
    drawClock();
}

function drag(event) {
    if (!isMouseDown) return;
    updateCursorPosition(event);
    handleSelection();
    drawClock();
}

function stopDrag() {
    isMouseDown = false;
    drawClock();
}

function singleClick(event) {
    updateCursorPosition(event);
    handleSelection();
    drawClock();
}

function updateCursorPosition(event) {
    canSelectedDrawn=false;
    const rect = canvas.getBoundingClientRect();
    cursorX = event.clientX - rect.left;
    cursorY = event.clientY - rect.top;
}

function handleSelection() {
    let found = false;

    if (currentMode === "hour") {
        for (let i = 0; i < hourPositions.length; i++) {
            const { x, y } = hourPositions[i];
            const dist = Math.sqrt(Math.pow(cursorX - x, 2) + Math.pow(cursorY - y, 2));
            if (dist < 13) {
                selectedPosition = i;
                found = true;
                break;
            }
        }

        for (let i = 0; i < innerHourPositions.length; i++) {
            const { x, y } = innerHourPositions[i];
            const dist = Math.sqrt(Math.pow(cursorX - x, 2) + Math.pow(cursorY - y, 2));
            if (dist < 13) {
                selectedPosition = i + hourCount;
                found = true;
                break;
            }
        }
    } else {
        // Check selectable minute positions (multiples of 5)
        for (let i = 0; i < minutePositions.length; i++) {
            const { x, y, value } = minutePositions[i] || {};
            const dist = Math.sqrt(Math.pow(cursorX - x, 2) + Math.pow(cursorY - y, 2));
            if (dist < 5) {
                selectedPosition = i;
                found = true;
                console.log(`Selected minute: ${value}`);
                document.getElementById('time-unitminuteID').textContent=value;
                break;
            }
        }

        // Log all minutes (non-selectable and selectable)
        if (!found) {
            for (let i = 0; i < allMinutePositions.length; i++) {
                const { x, y, value } = allMinutePositions[i] || {};
                const dist = Math.sqrt(Math.pow(cursorX - x, 2) + Math.pow(cursorY - y, 2));
                if (dist < 13) {
                    console.log(`Minute on clock (non-selectable): ${value}`);
                    document.getElementById('time-unitminuteID').textContent=value;
                    break;
                }
            }
        }
    }

    if (!found) {
        selectedPosition = null;
    }
}


function switchToMode(mode) {
    currentMode = mode;
    selectedPosition = null;
    drawClock();
}

document.getElementById('time-unithourId').addEventListener('click', () => {
    this.classList.add('selectedMode');
    document.getElementById('time-unithourId').classList.remove('selectedMode');
    outerRadius = clockRadius - 50;
    innerRadius = clockRadius - 20;
    switchToMode("hour");
});

document.getElementById('time-unitminuteID').addEventListener('click', () => {
    this.classList.add('selectedMode');
    document.getElementById('time-unitminuteID').classList.remove('selectedMode');
    outerRadius = clockRadius - 20;
    switchToMode("minute");
});

document.getElementById('time-unitsecondID').addEventListener('click', () => {
    outerRadius = clockRadius - 20;
    switchToMode("second");
});

canvas.addEventListener('mousedown', startDrag);
canvas.addEventListener('mousemove', drag);
canvas.addEventListener('mouseup', stopDrag);
canvas.addEventListener('mouseleave', stopDrag);
canvas.addEventListener('click', singleClick);

ctx.font = '16px Arial';
drawClock();



let currentSelectedDate = null;


function setTime(hour, minute, second ) {
    // Update global variables for the selected time
    currentSelectedTime.hour = hour;
    currentSelectedTime.minute = minute;
    currentSelectedTime.second


    // Automatically redraw the clock based on the current mode
    if (currentMode === "hour") {
        selectedPosition = currentSelectedTime.hour % 12; // Convert to 12-hour format
    } else if (currentMode === "minute") {
        selectedPosition = currentSelectedTime.minute; // Directly use minute
    } else if (currentMode === "second") {
        selectedPosition = currentSelectedTime.second; // Directly use second
    }

    drawClock(); // Redraw the clock
}

// Event listener for imgTimeNowId
document.getElementById('imgTimeNowId').addEventListener('click', () => {
    const now = new Date();
    const currentHour = now.getHours();
    const currentMinute = now.getMinutes();

    console.log(`Setting current time: ${currentHour}:${currentMinute}`);
    setTime(currentHour, currentMinute);
});

// Updated handleSelection for logging all minutes
function handleSelection() {
    let found = false;

    if (currentMode === "hour") {
        for (let i = 0; i < hourPositions.length; i++) {
            const { x, y } = hourPositions[i];
            const dist = Math.sqrt(Math.pow(cursorX - x, 2) + Math.pow(cursorY - y, 2));
            if (dist < 13) {
                selectedPosition = i;
                found = true;
                currentSelectedTime.hour = i; // Update selected hour
                break;
            }
        }

        for (let i = 0; i < innerHourPositions.length; i++) {
            const { x, y } = innerHourPositions[i];
            const dist = Math.sqrt(Math.pow(cursorX - x, 2) + Math.pow(cursorY - y, 2));
            if (dist < 13) {
                selectedPosition = i + hourCount;
                found = true;
                currentSelectedTime.hour = i + 12; // Update selected inner hour
                break;
            }
        }
    } else {
        for (let i = 0; i < minutePositions.length; i++) {
            const { x, y, value } = minutePositions[i] || {};
            const dist = Math.sqrt(Math.pow(cursorX - x, 2) + Math.pow(cursorY - y, 2));
            if (dist < 5) {
                selectedPosition = i;
                found = true;
                currentSelectedTime.minute = value; // Update selected minute
                console.log(`Selected minute: ${value}`);
                document.getElementById('time-unitminuteID').textContent = value;
                break;
            }
        }

        if (!found) {
            for (let i = 0; i < allMinutePositions.length; i++) {
                const { x, y, value } = allMinutePositions[i] || {};
                const dist = Math.sqrt(Math.pow(cursorX - x, 2) + Math.pow(cursorY - y, 2));
                if (dist < 13) {
                    console.log(`Minute on clock (non-selectable): ${value}`);
                    break;
                }
            }
        }
    }

    if (!found) {
        selectedPosition = null;
    }
}







    </script>

</body>
</html>
